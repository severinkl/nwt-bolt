# HTTP Level 2 Scenario - TCP and TLS Handshake
# Format: step;device;image(opt);wled(opt);time_sec(default=5);desc(opt);

1;main;000_init.png;;;;
2;main;001_TypeURL@Client.png;;;;
3;main;030_TCP_SYN@Client.png;main>switch;;Der Client startet den Verbindungsaufbau mit einem TCP SYN-Paket.;
4;switch;031_TCP_SYN@Transfer.png;switch>router;;Das SYN-Paket durchläuft das Netzwerk und wird weitergeleitet.;
5;router;031_TCP_SYN@Transfer.png;router>firewall;;Das SYN-Paket durchläuft das Netzwerk und wird weitergeleitet.;
6;firewall;031_TCP_SYN@Transfer.png;firewall>server;;Das SYN-Paket durchläuft das Netzwerk und wird weitergeleitet.;
7;server;038_TCP_SYN@Server.png;;;Der Server empfängt das SYN-Paket.;
8;server;039_TCP_SYNACK@Server.png;server>firewall;;Der Server antwortet mit SYN/ACK, um die Verbindung zu bestätigen.;
9;firewall;040_TCP_SYNACK@Transfer.png;firewall>router;;Das SYN/ACK-Paket tritt den Rückweg zum Client an.;
10;router;040_TCP_SYNACK@Transfer.png;router>switch;;Das SYN/ACK-Paket tritt den Rückweg zum Client an.;
11;switch;040_TCP_SYNACK@Transfer.png;switch>main;;Das SYN/ACK-Paket tritt den Rückweg zum Client an.;
12;main;045_TCP_SYNACK@Client.png;;;Der Client erhält die SYN/ACK-Antwort des Servers;
13;main;046_TCP_ACK@Client.png;main>switch;;Der Client bestätigt mit einem ACK das Zustandekommen der Verbindung.;
14;switch;047_TCP_ACK@Transfer.png;switch>router;;Das ACK-Paket wird über Switch übertragen;
15;router;047_TCP_ACK@Transfer.png;router>firewall;;Das ACK-Paket wird über Router übertragen;
16;firewall;047_TCP_ACK@Transfer.png;firewall>server;;Das ACK-Paket wird über Firewall übertragen;
17;server;051_TCP_ACK@Server.png;;;Der Server empfängt die Bestätigung (ACK).;
18;main;052_TCP_established@Client.png;;;TEAM: wär geil, wenn wir hier das LED durchgehend kurz beleuchten könnten;
18;server;052_TCP_established@Server.png;;;TEAM: wär geil, wenn wir hier das LED durchgehend kurz beleuchten könnten;
30;main;060_TLS_Clienthello@Client.png;main>switch;;Der Client startet die verschlüsselte Verbindung mit einem „ClientHello".;
31;switch;061_TLS_Clienthello@Transfer.png;switch>router;;Die TLS-Anfrage wird durch das Netzwerk weitergeleitet.;
32;router;061_TLS_Clienthello@Transfer.png;router>firewall;;Die TLS-Anfrage wird durch das Netzwerk weitergeleitet.;
33;firewall;061_TLS_Clienthello@Transfer.png;firewall>server;;Die TLS-Anfrage wird durch das Netzwerk weitergeleitet.;
34;server;064_TLS_Clienthello@Server.png;;;Der Server empfängt das „ClientHello".;
35;server;065_TLS_Serverhello@Server.png;;;Der Server antwortet mit einem „ServerHello".;
36;server;066_TLS_ServerCertificate@Server.png;server>firewall;;Der Server sendet sein digitales Zertifikat.;
37;firewall;067_TLS_ServerhelloCert@Transfer.png;firewall>router;;Das Zertifikat wird an den Client weitergereicht.;
38;router;067_TLS_ServerhelloCert@Transfer.png;router>switch;;Das Zertifikat wird an den Client weitergereicht.;
39;switch;067_TLS_ServerhelloCert@Transfer.png;switch>main;;Das Zertifikat wird an den Client weitergereicht.;
40;main;067_TLS_ServerhelloCert@Transfer.png;;;Das Zertifikat wird an den Client weitergereicht.;
41;main;071_TLS_Certcheck@Client.png;;;Der Client prüft die Echtheit und Gültigkeit des Zertifikats.;
42;main;072_TLS_Keyderivation@Client.png;;;Der Client erzeugt Schlüsselmaterial für die Verschlüsselung.;
42;server;072_TLS_Keyderivation@Server.png;;;Auch der Server erstellt den gemeinsamen Sitzungsschlüssel.;
43;main;073_TLS_Finish@Client.png;;;TEAM: wär geil, wenn wir hier das LED durchgehend kurz beleuchten könnten;
43;server;073_TLS_Finish@Server.png;;;TEAM: wär geil, wenn wir hier das LED durchgehend kurz beleuchten könnten;
50;main;080_HTTPget@Client.png;main>switch;;Ein Datenpaket mit einer Anfrage nach einer Webseite wurde vom Gerät erstellt. Dieses Paket wird jetzt an den Internetrouter (Gateway) gesendet.;
51;switch;081_HTTPget@Transfer.png;switch>router;;Das Datenpaket erreicht nun den Netzwerk-Switch. Dieser ist nicht das Gateway, daher leitet er es weiter zum Gateway.;
52;router;081_HTTPget@Transfer.png;router>firewall;;Paket durchläuft den Router. Dieser kennt die Route ins Internet und übermittelt es an die Firewall.;
53;firewall;081_HTTPget@Transfer.png;firewall>server;;Die Firewall ist der Übergang ins Internet. Sie überprüft, ob die Kommunikation erlaubt ist und überprüft ebenfalls auf schädliche Inhalte.;
54;server;084_HTTPget@Server.png;;;Die HTTP GET-Anfrage erreicht nun den Webserver und wird verarbeitet.;
55;server;085_QueryPage@WebserverORF.png;;;Der Webserver durchsucht die Datenbank und führt eine Abfrage für /index.html aus.;
56;server;086_FoundPage@WebserverORF.png;;;Der Webserver hat den Inhalt gefunden und bereitet ihn als Webseite vor.;
57;server;087_DeliverHTTPokWithContent@WebserverORF.png;server>firewall;;Das HTTP OK wird nun übermittelt und inkludiert den Content der Website.;
58;firewall;088_HTTPok@Transfer.png;firewall>router;;Das Paket trifft nun wieder bei der Firewall ein und wird überprüft.;
59;router;088_HTTPok@Transfer.png;;;Die Firewall hat das Paket an den Router übermittelt, welcher die Route retour zum Client kennt.;
60;router;089_Enrypted@Router.png;router>switch;;Zur Demonstration: Der Netzwerkverkehr ist VERSCHLÜSSELT. Ein Router, bzw. andere Parteien die mitlauschen, können den Traffic nicht interpretieren!;
61;switch;088_HTTPok@Transfer.png;switch>main;;Der Switch kennt die lokale MAC-Adresse des Clients und weiß, an welchem Port dieser anliegt. Er leitet das Paket einfach weiter.;
62;main;091_HTTPok@Client.png;switch>main;;Das Paket erreicht nun den Client. Die Webseite kann nun geladen und angezeigt werden.;
63;main;093_HTMLCode@Client.png;;;Der HTML-Code wird nun vom Browser interpretiert und die Webseite dargestellt.;
64;main;094_Website@Client.png;;;Das Ergebnis ist eine vollständig geladene Webseite welche dem Nutzer nun im Browser angezeigt wird.;
70;main;999_finish.png;;;;